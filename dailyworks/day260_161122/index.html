<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>#260 ZIPcode search</title>
</head>
<body>
  <h1></h1>

  <labal>郵便番号<input id="postcode" type="text" size="12" maxlength="8" placeholder="例:162-0825"></labal>
  <button id="btn">検索</button>
  <div id="result">
    <p><label>都道府県 <input id="pref" type="text" size="10"></label></p>
    <p><label>市区町村 <input id="city" type="text" size="10"></label></p>
    <p><label>住所 <input id="address" type="text"></label></p>
  </div>


  <p>参考：
  <a href="http://paiza.hatenablog.com/entry/2016/06/21/%E9%9D%A2%E5%80%92%E3%81%AA%E6%89%8B%E7%B6%9A%E3%81%8D%E4%B8%8D%E8%A6%81%EF%BC%81%E3%80%8CWeb_API%E3%80%8D%E3%81%AE%E8%B6%85%E3%81%8A%E6%89%8B%E8%BB%BD%E6%B4%BB%E7%94%A8%E8%A1%93%E3%82%92JavaScript">paiza開発日誌</a>
  </p>

<script>
  const btn = document.getElementById('btn');

  btn.addEventListener('click', () => {
    const postcode = document.getElementById('postcode');
    const pref = document.getElementById('pref');
    const city = document.getElementById('city');
    const address = document.getElementById('address');
    const script = document.createElement('script');

    script.src = "http://zipcloud.ibsnet.co.jp/api/search?zipcode=" + postcode.value + "&callback=jsonData";
    document.body.appendChild(script);
    document.body.removeChild(script);
  })

  function jsonData(data) {
    pref.value = data.results[0].address1;
    city.value = data.results[0].address2;
    address.value = data.results[0].address3;
  }

</script>

</body>
</html>
